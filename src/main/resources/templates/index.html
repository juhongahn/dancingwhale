<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>가지가지한다</title>

    <link th:href="@{/css/bootstrap.css}" href="../static/css/bootstrap.css" rel="stylesheet">
    <script type="text/javascript" th:src="@{/js/bootstrap.bundle.js}" src="../static/js/bootstrap.bundle.js"></script>
    <script src="https://kit.fontawesome.com/c2e67fd6d1.js" crossorigin="anonymous"></script>

    <style>
        .container {
            max-width: 470px;
        }
        .navbar .container{
            max-width: 600px;
        }
        .confirmBtn{
            background-color:  #7952b3;
            color: white;
        }
    </style>




</head>
<body>

<div th:replace ="~{fragment/header :: header}"></div>
<div th:replace ="~{fragment/writingModal :: modal}"></div>

    <div class="container">
        <!-- 본문 카드 -->
        <div th:if="${posts.size()==0}">
            텅...
        </div>

        <div class="card mt-2" th:unless ="${posts.size()==0}" th:each="post : ${posts}" style="width: 30rem;">
            <input type="hidden" name="postId" th:value="${post.id}">
            <div class="card-header d-flex justify-content-between ">
                <span th:text="${post.member.nickName}"></span>
                <div>
                    <i class="fas fa-edit"></i>
                    <i class="fas fa-trash-alt"></i>
                </div>

            </div>
<!--            <img src="..." class="card-img-top" style="width: 100%; height: 470px;" alt="...">-->
            <div class="card-body border-top">
                <div>
                    <span><i class="far fa-heart" th:onclick="|javascript:sendNewLikesRequest('${post.id}')|"></i>
                        <i class="far fa-thumbs-down"></i></span>
                </div>
                <span class="card-text" th:text="|좋아요 ${#lists.size(post.likesList)}|"></span>
                <p class="card-text" th:text="${post.description}">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                <form action="#">
                    <input type="text"/>
                    <button>댓글</button>
                </form>
            </div>
        </div>

    </div>
</body>
</html>


<script >

    var myModal = new bootstrap.Modal(document.getElementById('exampleModal'));
    var postSubmitBtn = document.getElementById('postSubmitBtn');
    postSubmitBtn.addEventListener('click', function (event) {
        sendNewPostRequest();
    });

    function sendNewPostRequest() {
        <!-- 모달에 있는 내용 -->
        var contentArea = document.getElementById('message-text');
        var content = contentArea.value;
        if (content.length === 0) {
            alert("내용을 입력해 주세요.");
        } else {
            fetch('/post/new', {
                method: 'post',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: new URLSearchParams({
                    'description': content
                })
            })
                .then(res => {
                    window.location.reload();
                })

            contentArea.innerText="";
            myModal.hide();
            alert("등록됐습니다.");
        }
    }

    function sendNewLikesRequest(postId) {

        fetch('/likes/new', {
            method: 'post',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: new URLSearchParams({
                'postId': postId
            })
        })
            .then(res => {
                window.location.reload();
                alert("등록됐습니다.");
            })

    }



</script>

